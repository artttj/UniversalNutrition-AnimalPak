From 972342b860578234553a96ca8b08feda25146033 Mon Sep 17 00:00:00 2001
From: Andrey Abumuslimov <aabumuslimov@magento.com>
Date: Wed, 18 Jan 2017 16:38:26 -0800
Subject: [PATCH] MDVA-2105: Quans: Layered Navigation - Only 10 filter options
 are returned from Elasticsearch

---
 .../Elasticsearch/SearchAdapter/Query/Builder/Aggregation.php      | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/vendor/magento/module-elasticsearch/SearchAdapter/Query/Builder/Aggregation.php b/vendor/magento/module-elasticsearch/SearchAdapter/Query/Builder/Aggregation.php
index f4624f5..a766db1 100644
--- a/vendor/magento/module-elasticsearch/SearchAdapter/Query/Builder/Aggregation.php
+++ b/vendor/magento/module-elasticsearch/SearchAdapter/Query/Builder/Aggregation.php
@@ -12,6 +12,12 @@
 class Aggregation
 {
     /**
+     * Max number of results returned per single term bucket, i.e. limit of options for layered navigation filter.
+     * Default Elasticsearch limit is 10
+     */
+    const DEFAULT_TERM_BUCKET_SIZE = 100;
+
+    /**
      * @var FieldMapperInterface
      */
     protected $fieldMapper;
@@ -60,6 +66,7 @@ protected function buildBucket(
                 $searchQuery['body']['aggregations'][$bucket->getName()]= [
                     'terms' => [
                         'field' => $field,
+                        'size'  => self::DEFAULT_TERM_BUCKET_SIZE
                     ],
                 ];
                 break;